{% load staticfiles %}
<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="">

    <link href='http://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet' type='text/css'>

    <title>TAGALONG app</title>

    <!-- Bootstrap core CSS -->
    <link href="/static/djangosnap/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/static/djangosnap/cover.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="{% static 'djangosnap/ie-emulation-modes-warning.js'%}"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="site-wrapper">

      <div class="site-wrapper-inner">

        <div class="cover-container">


          <div class="masthead clearfix">
            <div class="inner">
              <h3 class="masthead-brand"><img src ='/static/djangosnap/logo.png' width="40" height="40" />TAGALONG</h3>
              <nav>
                <ul class="nav masthead-nav">
                  <li><a href="http://tagalongapp.co#">Home</a></li>
                  <li><a href="{% url 'uploadit' %}">Upload</a></li>
                  <li class="active"><a href="http://tagalongapp.co/watch#">Watch</a></li>
                </ul>
              </nav>
            </div>
          </div>

          <div class="inner cover" id="innercover">
          <a class="btn left-align" onclick="previous()" style="visibility: hidden" id="previous"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span></a>


            {% if mediafiles %}
    {% for vid in mediafiles %}

        <video width="0" height="0" controls id="vid" style="visibility: hidden">
            <source src="{{ vid.mediafile.url }}" type="video/mp4">
            Your broswer doesn't support video tags
        </video>

        <img src="#" style="visibility: hidden" id="im"/>

    {% endfor %}
    {% else %}
    {% endif %}

          <a class="btn right-align" onclick="previous()" style="visibility: hidden" id="next"><span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
          </div>

          <div class="mastfoot">
            <div class="inner">
              <p><a href="https://twitter.com/GamronCodbout">@GamronCodbout</a>    <a href="https://twitter.com/PistolPiedt">@PistolPiedt</a>.</p>
            </div>
          </div>

        </div>

      </div>

    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/static/djangosnap/jquery.min.js"></script>
    <script src="/static/djangosnap/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="/static/djangosnap/ie10-viewport-bug-workaround.js"></script>

     <script type="application/javascript">

    var mediaURLS = [];
    {% if mediafiles %}
        {% for vid in mediafiles %}
            mediaURLS.push('{{ vid.mediafile.url|safe }}');
        {% endfor%}
    {% endif %}
    console.log(mediaURLS);
    var currentMediaIndex = 0;
    var currentMediaURL = "";
    if (mediaURLS.length > 0)
    {
        currentMediaURL = mediaURLS[currentMediaIndex];
        if (mediaURLS.length > 1)
        {
            $('#next' ).css("visibility","visible");
        }
        loadMedia();


    }

     function previousMedia()
     {
         var temp = currentMediaIndex - 1;
         if (temp >= 0 )
         {
             if (temp == 0)
             {
                 $('#previous').css("visibility","hidden");
             }
             currentMediaIndex--;
             loadMedia();
         }

     }

     function nextMedia()
     {
         var temp = currentMediaIndex + 1;
         if (temp < mediaURLS.length)
         {
             if (temp == mediaURLS.length -1)
             {
                 $('#next').css("visibility","hidden");
             }
             if (currentMediaIndex == 0)
             {
                 $('#previous').css("visibility","visible")
             }
             currentMediaIndex++;
             loadMedia(currentMediaIndex);
         }

     }

    function loadMedia()
    {
        var vid = isVid(mediaURLS[currentMediaIndex]);
        if (vid)
        {
            loadVideo();
        }
        else
        {
            loadImage();
        }
    }

     function loadVideo()
     {
         closeOutImage();
         var width = $('#innercover').width();
         var height = $('#inercover').height();
         $('#vid').css("visibility","visible");
         $('#vid').width(width);
         $('#vid').height(height);
         $('#vid').attr('src', mediaURLS[currentMediaIndex]);
         $('#vid')[0].load();
     }

    function loadImage()
    {
        closeOutVideo();
        var width = $('#innercover').width();
        var height = $('#inercover').height();
        $('#im').css("visibility","visible");
        $('#im').width(width);
        $('#im').height(height);
        $('#im').attr('src', mediaURLS[currentMediaIndex]);

    }

    function closeOutImage()
    {
        $('#im').css("visibility","hidden");
        $('#im').width(0);
        $('#im').height(0);
    }

    function closeOutVideo()
    {
        $('#vid').css("visibility","hidden");
        $('#vid').width(0);
        $('#vid').height(0);
    }

     function isVid(url)
     {
         var extension = url.substr(url.length - 3);
         if (extension === 'mp3')
         {
             return true;
         }
         return false;
     }
</script>
  </body>
</html>


